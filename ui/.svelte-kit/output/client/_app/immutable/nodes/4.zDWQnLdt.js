import{d as Y,c as T,a as y,f as I,s as re}from"../chunks/D0Lkw7OS.js";import{au as H,B as h,e as J,av as K,I as le,aw as ie,ax as oe,ab as se,ay as ne,l as ce,u as ve,r as de,p as ue,i as N,b as fe,d as v,f as n,h as d,g as c,c as f,M as G,t as U,az as me,s as _e,$ as be}from"../chunks/-jyIGn8U.js";import{h as pe}from"../chunks/Bp8PBraJ.js";import{i as ye}from"../chunks/C_Hl2iD9.js";import{i as L}from"../chunks/CWQxrqui.js";import{r as he}from"../chunks/1yrNtQYw.js";import{p as xe}from"../chunks/BvOK0ta7.js";function Q(e,a,s=!1){if(e.multiple){if(a==null)return;if(!le(a))return ie();for(var r of e.options)r.selected=a.includes(q(r));return}for(r of e.options){var i=q(r);if(oe(i,a)){r.selected=!0;return}}(!s||a!==void 0)&&(e.selectedIndex=-1)}function ge(e){var a=new MutationObserver(()=>{Q(e,e.__value)});a.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),se(()=>{a.disconnect()})}function ke(e,a,s=a){var r=new WeakSet,i=!0;H(e,"change",t=>{var o=t?"[selected]":":checked",l;if(e.multiple)l=[].map.call(e.querySelectorAll(o),q);else{var x=e.querySelector(o)??e.querySelector("option:not([disabled])");l=x&&q(x)}s(l),h!==null&&r.add(h)}),J(()=>{var t=a();if(e===document.activeElement){var o=K??h;if(r.has(o))return}if(Q(e,t,i),i&&t===void 0){var l=e.querySelector(":checked");l!==null&&(t=q(l),s(t))}e.__value=t,i=!1}),ge(e)}function q(e){return"__value"in e?e.__value:e.value}function we(e,a,s=a){var r=new WeakSet;H(e,"input",async i=>{var t=i?e.defaultValue:e.value;if(t=V(e)?z(t):t,s(t),h!==null&&r.add(h),await ne(),t!==(t=a())){var o=e.selectionStart,l=e.selectionEnd,x=e.value.length;if(e.value=t??"",l!==null){var k=e.value.length;o===l&&l===x&&k>x?(e.selectionStart=k,e.selectionEnd=k):(e.selectionStart=o,e.selectionEnd=Math.min(l,k))}}}),(ce&&e.defaultValue!==e.value||ve(a)==null&&e.value)&&(s(V(e)?z(e.value):e.value),h!==null&&r.add(h)),de(()=>{var i=a();if(e===document.activeElement){var t=K??h;if(r.has(t))return}V(e)&&i===z(e.value)||e.type==="date"&&!i&&!e.value||i!==e.value&&(e.value=i??"")})}function V(e){var a=e.type;return a==="number"||a==="range"}function z(e){return e===""?null:+e}var Se=I('<div class="p-5 space-y-4"><div><label for="country-select" class="label">Region</label> <select id="country-select" class="input"><option>Nigeria (+234)</option><option>USA (+1)</option></select></div> <div><label for="phone-input" class="label">Phone Number</label> <input id="phone-input" type="text" placeholder="8123456789" class="input"/></div> <button class="btn btn-primary w-full">Generate Code</button></div>'),Ce=I('<div class="p-12 text-center"><div class="w-8 h-8 border-2 rounded-full animate-spin mx-auto mb-3" style="border-color: hsl(var(--border)); border-top-color: hsl(var(--primary));"></div> <p class="text-sm" style="color: hsl(var(--text-muted));">Generating code...</p></div>'),Ee=I('<div class="p-5 text-center"><p class="text-xs font-medium mb-3" style="color: hsl(var(--text-muted));">Your pairing code</p> <div class="mono text-3xl font-bold py-4 px-6 rounded-lg mb-4" style="background: hsl(var(--bg)); color: hsl(var(--primary)); letter-spacing: 0.2em;"> </div> <button class="btn btn-secondary w-full mb-3"><i class="fi fi-rr-copy"></i> Copy</button> <button class="text-sm" style="color: hsl(var(--text-muted));">Done</button></div>'),Pe=I('<div class="modal-backdrop" role="dialog" aria-modal="true"><div class="modal-card" role="document"><div class="card-header flex justify-between items-center"><span>Link Device</span> <button class="w-7 h-7 rounded flex items-center justify-center hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors" style="color: hsl(var(--text-muted));"><i class="fi fi-rr-cross-small"></i></button></div> <!></div></div>');function je(e,a){ue(a,!1);let s=xe(a,"open",12,!1),r=G("setup"),i=G("234"),t=G(""),o=G("");function l(){s(!1),f(r,"setup"),f(t,""),f(o,"")}async function x(){const w=c(t).trim().replace(/^0/,"");if(!w)return;const _=c(i)+w;f(r,"loading");try{await fetch(`/api/instances/${_}/pair`,{method:"POST"});let b=0;const S=setInterval(async()=>{b++;const D=await(await fetch(`/api/instances/${_}`)).json();D.pairing_code&&(clearInterval(S),f(o,D.pairing_code),f(r,"result")),b>=20&&(clearInterval(S),l())},2e3)}catch{l()}}function k(){navigator.clipboard.writeText(c(o)),alert("Code copied!")}ye();var B=T(),X=N(B);{var Z=w=>{var _=Pe();_.__click=l,_.__keydown=u=>u.key==="Escape"&&l();var b=v(_);b.__click=u=>u.stopPropagation(),b.__keydown=()=>{};var S=v(b),F=n(v(S),2);F.__click=l,d(S);var D=n(S,2);{var $=u=>{var C=Se(),E=v(C),P=n(v(E),2);U(()=>{c(i),me(()=>{})});var j=v(P);j.value=j.__value="234";var m=n(j);m.value=m.__value="1",d(P),d(E);var p=n(E,2),M=n(v(p),2);he(M),d(p);var O=n(p,2);O.__click=x,d(C),ke(P,()=>c(i),g=>f(i,g)),we(M,()=>c(t),g=>f(t,g)),y(u,C)},ee=u=>{var C=T(),E=N(C);{var P=m=>{var p=Ce();y(m,p)},j=m=>{var p=T(),M=N(p);{var O=g=>{var W=Ee(),A=n(v(W),2),ae=v(A,!0);d(A);var R=n(A,2);R.__click=k;var te=n(R,2);te.__click=l,d(W),U(()=>re(ae,c(o))),y(g,W)};L(M,g=>{c(r)==="result"&&g(O)},!0)}y(m,p)};L(E,m=>{c(r)==="loading"?m(P):m(j,!1)},!0)}y(u,C)};L(D,u=>{c(r)==="setup"?u($):u(ee,!1)})}d(b),d(_),y(w,_)};L(X,w=>{s()&&w(Z)})}y(e,B),fe()}Y(["click","keydown"]);var qe=I('<section class="fade-in"><div class="card max-w-sm mx-auto p-8 text-center"><div class="w-14 h-14 rounded-xl flex items-center justify-center mx-auto mb-5" style="background: hsla(var(--primary) / 0.1);"><i class="fi fi-rr-smartphone text-xl" style="color: hsl(var(--primary));"></i></div> <h2 class="text-lg font-semibold mb-2" style="color: hsl(var(--text));">Connect Device</h2> <p class="text-sm mb-6" style="color: hsl(var(--text-muted));">Generate an 8-digit code to link your phone.</p> <button class="btn btn-primary w-full"><i class="fi fi-rr-link-alt"></i> Start Connection</button></div></section> <!>',1);function We(e){let a=_e(!1);var s=qe();pe("aj1tv1",l=>{J(()=>{be.title="Link Device | Whatsaly"})});var r=N(s),i=v(r),t=n(v(i),6);t.__click=()=>f(a,!0),d(i),d(r);var o=n(r,2);je(o,{get open(){return c(a)},set open(l){f(a,l,!0)}}),y(e,s)}Y(["click"]);export{We as component};
